# Node.js  
# Build a general Node.js project with npm.  
# Add steps that analyze code, save build artifacts, deploy, and more:  
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript  
  
trigger:  
- master  
  
pool:
  vmImage: ubuntu-latest
  
steps:  

- task: Npm@1  
  displayName: 'npm install'  
  inputs:  
    verbose: false  

- task: Npm@1  
  displayName: Build  
  inputs:  
    command: custom  
    verbose: false  
    customCommand: 'run ng build'  

  
- task: CopyPublishBuildArtifacts@1  
  displayName: 'Copy Publish Artifact: angular10'  
  inputs:  
    CopyRoot: dist  
    Contents: '**'  
    ArtifactName: test  
    ArtifactType: Container  
  

- task: Docker@0
  displayName: 'Build an image'
  inputs:
    azureSubscription: 'Visual Studio-MariemKh-002 (94ca701a-2c78-4bd5-b0df-6785d65fc462)'
    azureContainerRegistry: '{"loginServer":"webapplicationdemo12.azurecr.io", "id" : "/subscriptions/94ca701a-2c78-4bd5-b0df-6785d65fc462/resourceGroups/MeraiAnassRG/providers/Microsoft.ContainerRegistry/registries/WebApplicationDemo12"}'

- task: Docker@0
  displayName: 'Push an image'
  inputs:
    azureSubscription: 'Visual Studio-MariemKh-002 (94ca701a-2c78-4bd5-b0df-6785d65fc462)'
    azureContainerRegistry: '{"loginServer":"webapplicationdemo12.azurecr.io", "id" : "/subscriptions/94ca701a-2c78-4bd5-b0df-6785d65fc462/resourceGroups/MeraiAnassRG/providers/Microsoft.ContainerRegistry/registries/WebApplicationDemo12"}'
    action: 'Push an image'